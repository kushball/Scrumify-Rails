<% title "Timecard" %>

<strong><%= @timecard.user.name %></strong><br />
<strong>Last Updated: </strong> <%= @timecard.updated_at.strftime("%m/%d/%Y at %l:%M %p") %><br/><br/>

<div id="show_timecard">
		    <% if @timecard %>
		    <% week = ["Saturday",  "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday"] %>
			<div class="table_title">Actuals - <%=  @period.actual_starts_on.to_formatted_s(:long) + "-" + @period.actual_ends_on.to_formatted_s(:long) %> </div>
		    <table id="admin_table">
			<thead>
		    <th>Charge Number</th>
		    <% for day in week %>
		      <th><%= day %> </th>
		    <% end %>

			</thead>
		    <% hours = 0 %>
		 	<tbody>
		    <% for num in @charge_numbers %>
		      <tr>
		      <td><%= @group.name + num.name + ":  " + num.description %></td>
		      <% for day in week %>
		        <% hours = 0 %>
		        <% num.time_logs.where(:timecard_id => @timecard.id).each do |log| %>
		          <% if log.actual %>
		            <% if log.day == day %>
		              <% hours += log.hours %>
		            <% end %>
		          <% end %>
		        <% end %>
		          <td><% if(hours) > 0 %>
			         <%= hours %>
		              <% else %>
				 <%= "" %>
		              <% end %></td>
		      <% end %>
		    </tr>
		    <% end %>
			</tbody>
		</table>
		    <div class="table_title">Estimates: <%=  @period.estimate_starts_on.to_formatted_s(:long) + "-" + @period.estimate_ends_on.to_formatted_s(:long) %></div>
		    <table id="admin_table">
			<thead>
		    <th>Charge Number</th>
			    <% for day in week %>
			      <th><%= day %> </th>
			    <% end %>
		    </thead>
			<% hours = 0 %>
			<tbody>
		    <% for num in @charge_numbers %>
		      <tr>
		      <td><%= @group.name + num.name + ":  " + num.description %></td>
		      <% for day in week %>
			<% hours = 0 %>
		        <% num.time_logs.where(:timecard_id => @timecard.id).each do |log| %>
		          <% if !log.actual %>
		            <% if log.day == day %>
				<% hours += log.hours %>
		            <% end %>
		          <% end %>
		        <% end %>
		          <td><% if(hours) > 0 %>
			         <%= hours %>
		              <% else %>
				 <%= "" %>
		              <% end %></td>
		      <% end %>
		    </tr>
		    <% end %>
			</tbody>
		</table>


		    <p><b>Total Actual Hours: </b>
		      <%= @timecard.total_actual_hours %>
		    </p>
		    <p><b>Total Estimate Hours:</b>
		      <%= @timecard.total_estimate_hours %>
		    </p>
		    <p><b>Accomplishments:</b></br>
		      <%= @timecard.done %>
		    </p>
		    <p><b>Issues:</b><br />
		      <%= @timecard.issues %>
		    </p>
		    <p><b>Plan for next week:</b><br />
		      <%= @timecard.todo %>
		    </p>
		    <p><b>Risks:</b><br />
		      <%= @timecard.risks %>
		    </p>
		    <% else %>
				No Timecards Yet.
		    <% end %>
	</div>

<p>
  <%= link_to "Back to Timecard Grader", time_card_grader_path %>
</p>
